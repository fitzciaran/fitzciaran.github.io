pilot select should be one image and click through options
    should be able to select color and....other stuff?
powerups shouldn't spawn too close to ships (not super important for now)

start building test suite for this project
shooting stars effect
gravity black hole - reappear warp
powerups and black holes disappear after time, blinking out at the end.
moving powerUps

lobby selection
    simple lobby system could just be selecting from a list of lobbies and that sets which array of id's you use - from there it works the same p2p as now

1 player mode select?
select ship - different stats - different... special?
    specials... invicible, knock away in radius,mines?

char select effects/ design
music
sound effects

need some forground objects to get sense of speed

When a ship collides with one of these the ship should get slightly bigger. 
    We'll need to keep track of all ships size
    When ships collide with each other the biggest should "win" and the smaller should be removed from the game for 3 seconds before respawning at a random location 
or the front of the ship stabs?

shrinking level - could be all around or could be left to right to require progress

some kind of share option - a la wordle 

enemies - lose point if touched
different types ^
PvE?
general racing 
    like this - power up could be speed boost, or have separate boosts and power ups are mk style
    drafting mechanic?
    "jumps?"
    lap records
    daily/all time leaderboards

    gates
procedural level generation?

basic carfootball style game?

some kind of starting state whether for ^ or other

new challenger approaches when connect to someone
some kind of run game with the mouse / ship mechanic/physics we have
sumo mechanic? - with static kill obstacles? or just for non star interactions?
how to p2p with run style game
maybe colliding just kills both players?
maybe other things to avoid too - like not "fake players" but general enviroment obstacle

secret button to become master or to give up master status for testing - might be unneccesary
might have to do a proper server for master game state - daily leaderboards
on screen arrow to direct to offscreen oppoents
update UI of drawn oppoents name on craft in the world
color select on craft select
style table of current leaders
make ships bigger
maybe always provide thrust at low level - with limited click boost - need rechargable boost meter. - lean into these for char differences

share connection list so everyone matches - master only shares list of connected id's - if master shares an id not in list add it, if master is missing one maybe need a push to master.
issue when master disconnects.. or not quite disconnects but stops being active, maybe some kind of timer and if no message disconnect... might need to send a message to others to disconnect from it too...?
or at least check connections/otherPlayers list for one's that should be removed (how to check "inactive" - could maintain a "ticks since last message" variable or maybe better to timestamp the last update sent)

deal with null id (peers not working) better, probably make master, maybe more.
a new challenger approaches  screen when someone joins?
getting pulled in the direction of a few different types of games currently ... thats fine for now tho
rollback prediction for other players? or even for ai that master is processing?

camera follow host before the game starts? - try out following the bots see how it is.

move player processing logic into the player object so can use for bots.
maybe move player inputs into player logic for same reason

bots can appear jittery on non-master peers

need to introduce the idea of ongoing game so lose state for one is only local for them
maybe you lose health as time goes by and you have to keep up with picking up power ups to restore?
neaten current scores text - maybe put in a box too? 
some visual effect when ships hit
draw shadows
leader mark drawn - bonus for killing
way to attack without getting hurt - maybe speed/angle - maybe states - pacman style? mario star style?
     - maybe when collected a few normal power ups? maybe they fill a guage which drains slowly which thrusting
    - this would become the way mainly score
make ships much bigger
Compete for large moving powerups, possibly in addition to the star mario/pac man state
maybe also moving large obstacles (non-lethal?) pushing? and lethal.
level ups? more gauges?
worldDimensions maybe don't let Player know about this an have to always pass in a parameter to methods?
camera shake

bots should "run" from players with powerups?

faster when star??
gauge to show invicibletime? or use audio? - stop flashing slightly before? - for local player only?
display combo multiplier in ui (when above 1)?
spawn protection?
something to make text more visible in general
update "powerups" verbage to "score" throughout
update follow code to take into acount velocity of ship following. - maybe consider how far away to determine how far ahead to look
include kills tracking in leaderboard/score report?
notion of lives 3,2,1 GO if hit and have lives left - animation showing life icon being removed.
keep track of killed by and show on screen
keep track of historical kills? - revenge kill bonus/acknowledgement? 
- unique messaging if killed by multiple times? rival?

background on name entry like on the leaderboards/lore
refactor box drawing?
check this probably doesn't work but have put something in: timer for how long since heard from master... kick master from connections and otherplayers if 
issue with non-master peer sometimes powerups/enemies get restored (presumably by the master) as soon as we hits them, resulting in multiple hits/collection/kills
wait to see if will connect to a master before creating bots/powerups ourselves. - hopefully before playing ourselves... maybe hold off on showing game??
consider better options for right click. 
    - push away
         - could apply force to anything within a range? force could be uniform or based on how close but should be directed away from ship - uses stocks?
         - could suck in when star mode?
     -mines
     -warp? why? escape?

another, closer, "inRangeticks variable for botstate?
r2d2 sound for bumble boost?
seems too random to get hit, no prolonged engagement either get hit or don't and not engaged anymore...
2nd (3rd, 4th) state for after something.. is collectively achieved, opens worm hole etc, opens part of the edge .. boss?

as masterpeer need to process otherplayers' movement based on prev velocity and mouse position and space press might improve detection of collisions 
as nonmaster peer need to process otherplayers' and bots movement based on.....
instead/as well as power ups we have gates.... which maybe are also portals?.. randomly?
gates could be curated or iteligently generated in sets to allow for mini circuits/building up flowgates could blinks before for "gate" I'm thinking   |----|     so 2 lines marking the frame and a 'large" opening you go through in a particular direction (2 choices of direction, but could have directional ones.)

idea of a crash? hitting a gate  edge too fast? need to at least deal with collision... unless hitting edge kills always
faster you go through a gate the more points/ more stuff?

speed being a factor in normal kills? your velocity or relative impact velocity? could give more points/star time for fast, or too slow might not kill?

as combo (or some kinda of gate combo) builds could enter state of more difficult generated gate patterns.

notion of health?health could decrease and gating could increase, like arcade checkpoint race system
botstate to try to traverse the gates

make bot an inherited calss from player?
bots don't seem to be colliding with each other

instead of lore do pilot stats.
instead of hover over 1 or 2 have a 
safe starting/respawning area? forcefielded off?
separate p2p connection and db connection

name? space.io? 

bot could consider bouncing off the wall as means to quickly boost towards the center - should be a late implementation since walls may go and would be a very specific implementation
    -maybe not too tricky, check if close to a wall and if target is perpendiulatly far from the wall and momentum perpendicual component of velocity is towards the wall and would be a good candiate to head to wall.
    
issue where sometimes old connections get joined to and if they have a low id they will be master but not send anything(since they're closed) can I somehow close these?

as the bots get better I'll need to add in some more flaws. 
   maybe they set course less frequently, and a a distance set an inaccurate target
   variable for last course correction perhaps and use that and distance from taget to decide whether to adjust or hold.
   maybe hold course for just a moment after getting power up for example
   while no thrust
   could use boost when far and chasing

maybe star drains slower if no throttle at all.

more pilot stats e.g. 
    speed,boost speed, invicible time,push/pull strength


when observing a bot and they die, should switch to a different one.
sometimes non-master can not get credited for powerup collection (even when connection seems good otherwise)

timesince last message from master check shouldn't be in handledata since if no data to handle we don't get there to fix the connection issue
bot should give up on target following if target is dead!

apply less pull if they are star?
pull into front rather than full circle around? - maybe as different power?
drain their force power if in the pull range?

collision should be based on actual hitbox, 
bot targeting could be based on distance - if the bot "sees" a target it will go for it.... periodically could check it's "sight"
    could/should the facing direction be factored into this?

move powerups to entity
    move collision to general entity check with onColide function(method?) to run.

build charge if still? or if press/hold a charge button?
    inv power?
    a boost charge?

a brake?
a control style switch? (follow mouse?)

circles you have to stop in / stay in for x seconds for ... something? power up? charging in there?
mines need to spawn away from ships and ships need to spawn away from mines


still the issue where a collision is clearly detect (e.g. go over mine and mine disappears) but the hit doesn't register for non-master peer.

for fast speeds might need to calculate movement in half or quater frames to check for collision.

might have to rethink the force having as reference to tracks player

player property for still in initial setup?

credit "pushed" kills?

could put a collectedby property on powerups then schedule removal for a few frames time, but during that time only the "collectedby" player will have acknowledgement of collection (also don't draw while scheduled removal)
    more hacks to combat the big issue of p2p tho isnt it?


if implement full hitboxes could have the front bit be invincible.

give bots specials and make them use them on defense / offence

mine could have an attractive force (or repellent? )

deal with stack of messages (like when have been paused in debgger) better

deal with non-master drawing of forces (interpolate like with players should do it)

Be more selective about what data send? currently sending everything for bots/forces and not using everything, could speed up data transfer.

Don't convert all bot (and forces/mines etc) to proper class since we don't them in most cases anyway. - optimise

spawn warning for mines for example

still issue with the interpoloation of position of crafts/forces

boost areas are just forces now... well current forces are point based maybe need direction based variant 

//gotHit and addScore are both doing an additional key function of sending the playerstates as master. 
//Need to unpick this, maybe there should be events for gotHit and addscore and masterpeer responds to such events with sending player state for the given player

look into performance maybe only stroke/ closepath/open path at end/beginning of all force draws?

animate the force arrows?
only need to draw if drawing would be onscreen! How is this optimised by default?

if make directional forces bigger after creation need to reset numberArrowsEachSide so it's recalculated

  bots detect if stuck on forces? 
    advanced: use predicted forces to determine where should aim

points on screen when powerup collection

direction forcepads should not spawn too close to a wall if facing that wall

general collision visual effect (sound later)
    just write "BOOM!" for now? mix it up with "CRASH!!"

should remove/move boost / forcepads after a time... maybe just give them an actual expiry?

speicals should pull / push mines/powerups?
    could only pull powerups but they pull quite slowly?

should "combo score" shown be the total score throughout the combo?
    differnt sound effect for extent of score in combo.. probably not.

invicible could keep combo going even outside of normal tick time?

random effects - stuck with special on for a period of time.

add favicon.ico to source

still sometimes get a blank "killed by" .. could at least put ??? to cover case?.. or make sure not to inlcude "killed by" line

scores of the week?(last 7 days?)
    All time scores?

other unique properties for pilots?size? 
    max invincible time personal to pilot

completely different graphic for star/invic timer?.

some kind of background warping / blurring for the point gravity wells

screenshake

don't draw offscreen stuff!!


character whose special changes between all the specials

force refresh if fall behind in execution time?

way to throw away peerjs messages?
    maybe disconnect is delayed message? can reconnect later and not add to the backlog?


spawn check that itterates through all current objects and gives space (could just keep rerolling rng until a valid spot? should be fine as long as there's more valid spots than invalid)

power up could have a push point force? (Might have issue with bots getting them?)

if anotherplayer leaves we should remove their character after no message for x time

check getting hit by idle/left (and non drawn otherplayer) check general connection

maybe point forces should have very strong grav right at center...but dont to make slingshot worse.. maybe an actual pos move when near center?

keep track of a list of names that you killed and killed by for flavor text when die and for...

if new player joins and becomes master it takes over the gamestate - bots, mines,powerups,forcepads... 
    ideally it first takes the current masters state before taking over...not sure how to work that though... 

in transition of master collision detection allows multiple collections...
cover the master switching with some kind of in game lore event / effect? storm activating or something? No interactions during the "event" when event is done could push startStorm and frameOfStorm, so all could finish at the same time

animation for pre spawn? play for 30 frames before object?

send only changed data in standard master send, new slave peers need to request full update

known camera follow bug if no bots alive and spectating (could )

pilots portrait while in game? with powerup icon?
    could animate like the old carmageddon

make the score / combo text bigger and more obnoxious, whoosh at screen?

mines/...stuff could randomly/sporadically change color

accept master updates only if agree it's from master (add sending id to payload)
add a "request full update" payload for when set new master peer. have master peer handle that and limit how frequently it sends those out, since many peers could request that in quick succession, perhaps exponential backoff on subsequent sends.
maybe have basic player updates include who they consider master peer? could be used to trigger choosenewmaster

ensure unique id's for entities

sometimes can get into game without name set (think without pilot set too?)

blocking troll error screen overlay if "specs too low"

once connections are more optimized revisit the position easing, could be better less or more. THink the occasional brief flickering across screen might be to do with that.
    could make it ease only the final few pixels.

might be able to try ignoring old messages again once optimised

i think sometimes the invic loss from a mine/other collision might get synced away for slave peers.
 guessing sometimes the timing works out so they send their invic value to the master and the master accepts it

 udpate the bot/mine/force/powerup isequalfunctions to be isEqualForUpdatePurposes and allow certain things to be different so we're not sending for everything